---
title: "Initiate Batch Call Using Sheet"
api: "POST /initiateBatchCallUsingSheet"
description: "Upload CSV/Excel file to initiate batch calls (supports 10,000+ contacts)"
---

## Overview

Upload a CSV or Excel file containing contact details to initiate batch calls. Supports large datasets (10,000+ contacts).

---

##  Authentication

<ParamField header="x-api-key" type="string">
  Optional API key for authentication
</ParamField>

---

##  Request (Multipart Form Data)

<ParamField body="batchFile" type="file" required>
  CSV or Excel file with contact data
  
  **Supported Formats:**
  - CSV (.csv)
  - Excel (.xlsx, .xls)
  
  **Max Size:** 50MB
  
  **Required Columns:**
  - `phone_number` - Contact phone number (E.164 format)
  
  **Optional Columns:**
  - `name` - Contact name
  - `email` - Email address
  - Any custom fields (passed as custom_data)
</ParamField>

<ParamField body="agent_id" type="string" required>
  Script/Agent ID to use for all calls
  ```
  507f1f77bcf86cd799439011
  ```
</ParamField>

<ParamField body="campaign_id" type="string">
  Optional campaign ID
</ParamField>

---

##  File Format Example

### CSV Format:
```csv
phone_number,name,email,company,product_interest
+919876543210,John Doe,john@example.com,Acme Corp,Premium Plan
+919876543211,Jane Smith,jane@example.com,Tech Inc,Basic Plan
+919876543212,Bob Johnson,bob@example.com,StartUp Ltd,Enterprise Plan
```

### Excel Format:
| phone_number | name | email | company | product_interest |
|--------------|------|-------|---------|------------------|
| +919876543210 | John Doe | john@example.com | Acme Corp | Premium Plan |
| +919876543211 | Jane Smith | jane@example.com | Tech Inc | Basic Plan |

---

## Response

### Success Response (200 OK):
```json
{
  "success": true,
  "message": "Batch call initiated from file",
  "data": {
    "total_contacts": 3,
    "valid_contacts": 3,
    "invalid_contacts": 0,
    "batch_id": "batch_xyz789",
    "status": "processing",
    "estimated_time": "5-10 minutes"
  }
}
```

---

## Code Examples

### cURL:
```bash
curl -X POST "https://api.voicegenie.com/initiateBatchCallUsingSheet" \
  -F "batchFile=@/path/to/contacts.csv" \
  -F "agent_id=507f1f77bcf86cd799439011" \
  -F "campaign_id=campaign_abc123"
```

### JavaScript (with FormData):
```javascript
const axios = require('axios');
const FormData = require('form-data');
const fs = require('fs');

async function initiateBatchCallUsingSheet(filePath, agentId, campaignId) {
  const form = new FormData();
  form.append('batchFile', fs.createReadStream(filePath));
  form.append('agent_id', agentId);
  if (campaignId) form.append('campaign_id', campaignId);
  
  const response = await axios.post(
    'https://api.voicegenie.com/initiateBatchCallUsingSheet',
    form,
    {
      headers: form.getHeaders()
    }
  );
  
  console.log(`‚úÖ ${response.data.data.total_contacts} contacts uploaded`);
  console.log(`   Processing batch: ${response.data.data.batch_id}`);
  
  return response.data.data;
}

// Example
initiateBatchCallUsingSheet(
  './contacts.csv',
  '507f1f77bcf86cd799439011',
  'campaign_abc123'
);
```

### Python:
```python
import requests

def initiate_batch_call_using_sheet(file_path, agent_id, campaign_id=None):
    url = "https://api.voicegenie.com/initiateBatchCallUsingSheet"
    
    files = {
        "batchFile": open(file_path, "rb")
    }
    
    data = {
        "agent_id": agent_id
    }
    
    if campaign_id:
        data["campaign_id"] = campaign_id
    
    response = requests.post(url, files=files, data=data)
    
    if response.status_code == 200:
        result = response.json()['data']
        print(f"‚úÖ Uploaded {result['total_contacts']} contacts")
        print(f"   Batch ID: {result['batch_id']}")
        print(f"   Estimated time: {result['estimated_time']}")
        return result
    else:
        print("‚ùå Error:", response.json())
        return None

# Example
initiate_batch_call_using_sheet(
    "./contacts.csv",
    "507f1f77bcf86cd799439011",
    "campaign_abc123"
)
```

---

## üîß Multer Configuration

```javascript
const multer = require('multer');
const upload = multer();

router.post("/initiateBatchCallUsingSheet", 
  upload.single('batchFile'), 
  initiateBatchCallUsingSheet
);
```

**Field Name:** `batchFile` (must match in form-data)

---

## Processing Details

1. **File Upload:** File is uploaded and validated
2. **Parsing:** CSV/Excel parsed to extract contact rows
3. **Validation:** Phone numbers validated (E.164 format)
4. **Queue:** Valid contacts added to call queue
5. **Async Processing:** Calls initiated asynchronously
6. **Notifications:** Progress updates via WebSocket

---

## Important Notes

<Warning>
  **Async Processing:** Large files are processed asynchronously. Use WebSocket or polling to track progress.
</Warning>

<Note>
  **Phone Number Format:** All phone numbers must be in E.164 format (e.g., +919876543210). Invalid numbers are skipped.
</Note>

---

## Related Endpoints

- [Initiate Call](/api-reference/third-party/initiate-call) - Single call
- [Initiate Batch Call](/api-reference/third-party/initiate-batch-call) - JSON batch
- [WebSocket Events](/api-reference/websockets/real-time-events) - Track progress
