---
title: "Initiate Batch Call Using Sheet"
api: "POST /initiateBatchCallUsingSheet"
description: "Upload CSV/Excel file to initiate batch calls (supports 10,000+ contacts)"
auth: "bearer"
---

## Overview

Upload a CSV or Excel file containing contact details to initiate batch calls. Supports large datasets (10,000+ contacts).

---

## Headers

<ParamField header="Content-Type" type="string" required>
  multipart/form-data
</ParamField>

<ParamField header="Authorization" type="string" required>
  Bearer token for authentication
  
  **Options:**
  - Regular JWT token: `Bearer <JWT_TOKEN>` (from login response)
  - Static batch token: `Bearer <BATCH_STATIC_TOKEN>` (never expires - contact support)
</ParamField>

<ParamField header="Cookie" type="string">
  Alternative authentication via cookie: `token=<JWT_TOKEN>`
  
  Use this if not using Authorization header
</ParamField>

<ParamField header="Origin" type="string" required>
  Origin of the request (must be whitelisted)
</ParamField>

<ParamField header="User-Agent" type="string">
  Browser or client user agent
</ParamField>

---

##  Authentication

<Note>
  **Static Batch Token** (recommended for integrations): Never expires, ideal for automated file uploads. Contact support to obtain your static token.
</Note>

---

##  Request (Multipart Form Data)

<ParamField body="campaignId" type="string" required>
  Campaign ID to associate all calls with (mandatory)
  ```
  b885b212-d3bb-482f-a29d-508d2a8929ac
  ```
</ParamField>

<ParamField body="notificationWebhookUrl" type="string">
  Optional webhook URL for call status notifications
  ```
  https://overindulgently-unbreezy-colleen.ngrok-free.dev/getCallbackdata
  ```
</ParamField>

<ParamField body="file" type="file" required>
  CSV or Excel file with user data (attach as form data)
  
  **Supported Formats:**
  - CSV (.csv)
  - Excel (.xlsx, .xls)
  
  **Max Size:** 50MB
  
  **Required Columns in file:**
  - `userName` - User name
  - `userPhoneNumber` - User phone number (without + prefix)
  - `metaData` - JSON object containing custom fields (can be empty {})
  
  **Example user data structure:**
  ```json
  {
    "userName": "Faiz",
    "userPhoneNumber": "919625147093",
    "metaData": {}
  }
  ```
  
  **Example CSV structure:**
  ```csv
  userName,userPhoneNumber,metaData
  Faiz,919625147093,"{}"
  John Doe,919876543210,"{""due_amount"":""4500"",""company_name"":""H-D-B financial services""}"
  ```
</ParamField>

---

##  File Format Example

### CSV Format:
```csv
userName,userPhoneNumber,metaData
Faiz,919625147093,"{}"
John Doe,919876543210,"{""due_amount"":""4500"",""company_name"":""H-D-B financial services"",""loan_id"":""1234""}"
Jane Smith,919876543211,"{""due_amount"":""3000"",""company_name"":""ABC Corp""}"
```

### Excel Format:
| userName | userPhoneNumber | metaData |
|----------|-----------------|----------|
| Faiz | 919625147093 | `{}` |
| John Doe | 919876543210 | `{"due_amount":"4500","company_name":"H-D-B financial services"}` |

---

## Response

### Success Response (200 OK):
```json
{
  "success": true,
  "message": "Batch call initiated from file",
  "data": {
    "total_users": 3,
    "valid_users": 3,
    "invalid_users": 0,
    "batch_id": "batch_xyz789",
    "status": "processing",
    "estimated_time": "5-10 minutes"
  }
}
```

---

## Code Examples

### cURL:
```bash
curl -X POST "https://vb-seamless-dev-backend.oriserve.com/initiateBatchCallUsingSheet" \
  -F "campaignId=b885b212-d3bb-482f-a29d-508d2a8929ac" \
  -F "notificationWebhookUrl=https://overindulgently-unbreezy-colleen.ngrok-free.dev/getCallbackdata" \
  -F "file=@/path/to/contacts.csv"
```

### JavaScript (with FormData):
```javascript
const axios = require('axios');
const FormData = require('form-data');
const fs = require('fs');

async function initiateBatchCallUsingSheet(filePath, campaignId, notificationWebhookUrl = null) {
  const form = new FormData();
  
  // Required fields
  form.append('campaignId', campaignId);
  form.append('file', fs.createReadStream(filePath));
  
  // Optional field
  if (notificationWebhookUrl) {
    form.append('notificationWebhookUrl', notificationWebhookUrl);
  }
  
  const response = await axios.post(
    'https://vb-seamless-dev-backend.oriserve.com/initiateBatchCallUsingSheet',
    form,
    {
      headers: form.getHeaders()
    }
  );
  
  console.log(`✅ ${response.data.data.total_users} users uploaded`);
  console.log(`   Processing batch: ${response.data.data.batch_id}`);
  
  return response.data.data;
}

// Example
initiateBatchCallUsingSheet(
  './contacts.csv',
  'b885b212-d3bb-482f-a29d-508d2a8929ac',
  'https://overindulgently-unbreezy-colleen.ngrok-free.dev/getCallbackdata'
);
```

### Python:
```python
import requests

def initiate_batch_call_using_sheet(file_path, campaign_id, notification_webhook_url=None):
    url = "https://vb-seamless-dev-backend.oriserve.com/initiateBatchCallUsingSheet"
    
    # Required form data
    data = {
        "campaignId": campaign_id  # Mandatory
    }
    
    # Optional form data
    if notification_webhook_url:
        data["notificationWebhookUrl"] = notification_webhook_url
    
    # File attachment
    files = {
        "file": open(file_path, "rb")
    }
    
    response = requests.post(url, files=files, data=data)
    
    if response.status_code == 200:
        result = response.json()['data']
        print(f"✅ Uploaded {result['total_users']} users")
        print(f"   Batch ID: {result['batch_id']}")
        print(f"   Estimated time: {result['estimated_time']}")
        return result
    else:
        print("❌ Error:", response.json())
        return None

# Example
initiate_batch_call_using_sheet(
    "./contacts.csv",
    "b885b212-d3bb-482f-a29d-508d2a8929ac",  # Mandatory campaignId
    "https://overindulgently-unbreezy-colleen.ngrok-free.dev/getCallbackdata"  # Optional notificationWebhookUrl
)
```

---

##  Multer Configuration

```javascript
const multer = require('multer');
const upload = multer();

router.post("/initiateBatchCallUsingSheet", 
  upload.single('file'), 
  initiateBatchCallUsingSheet
);
```

**Field Name:** `file` (must match in form-data)

---

## Processing Details

1. **File Upload:** File is uploaded and validated
2. **Parsing:** CSV/Excel parsed to extract contact rows
3. **Validation:** Phone numbers validated (E.164 format)
4. **Queue:** Valid contacts added to call queue
5. **Async Processing:** Calls initiated asynchronously
6. **Notifications:** Progress updates via WebSocket

---

## Important Notes

<Warning>
  **Async Processing:** Large files are processed asynchronously. Use WebSocket or polling to track progress.
</Warning>

<Note>
  **Phone Number Format:** All phone numbers should be provided without the + prefix (e.g., 919876543210). Invalid numbers are skipped.
</Note>

---

## Related Endpoints

- [Initiate Call](/api-reference/third-party/initiate-call) - Single call
- [Initiate Batch Call](/api-reference/third-party/initiate-batch-call) - JSON batch
- [WebSocket Events](/api-reference/websockets/real-time-events) - Track progress
